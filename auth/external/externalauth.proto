syntax = "proto3";

package fabio.auth.external;

service Authorization {
    rpc Check(CheckRequest) returns (CheckResponse) {}
}

message CheckRequest {
    map<string, string> headers = 1;
    Source source = 3;
    Destination destination = 4;
}

message Source {
    string remote_addr = 1;
    string url = 2;
}

message Destination {
    string service = 1;
    string url = 3;
}

message CheckResponse {
    bool ok = 1;
    map<string, string> headers = 2;
}